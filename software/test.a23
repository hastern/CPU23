%This is test file for the asm23
%author: Hanno Sternberg <hanno@almostintelligent.de>
% 
% Offset 0x000000 Reset Address
#0x000042
% offset 0x000001 CPU UID
#0x23C0DE 
% offset 0x000002 All Zeros
#0x000000 
% offset 0x000003 All Ones
#0xFFFFFF 
% offset 0x000004 Random
#0x001337 
% offset 0x000005 Pseudo Random (23 Bit LFSR) [XNOR 23,18]
#0x001337 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
% offset 0x00000B - 0x000022  Interrupt vectors
#0x000042 % Reset Interrupt
#0x000000 % Timer Interrupt
#0x000000 % Keyboard Interrupt
#0x000000 % Mouse Interrupt
#0x000000 % UART TX Interrupt
#0x000000 % UART RX Interrupt
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x0F00BA 
% offset 0x000023             Interrupt selection / DMAAddr
#0x000000 
% offset 0x000024 - 0x00003A  DMA01 - 11 (Write only)
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x000000 
#0x001DEA 
% offset 0x00003B - 0x000040  Basic Interrupt handling routine
BIT SR SR #0xE   % Reset Interrupt-Flag in SR
SET IS #0x23     % Set constant interrupt selection address
LDR IS IV        % Load interrupt vector
AND IV IM IS     % Mask interrupt vector with interrupt mask
BRA IR           % On inactive Interrupt Return to normal program
JMP IH           % Jump to interrupt handler
HLT              % Security measure, should never be reached
% offset 0x000042: Here be programs
SET R3 #0x7
SET R0 #0x01 % Set Register R0 to '1'
SET R1 #0x02 % Set Register R1 to '2'
ADD R0 R1 R2 % Add Registers R0 and R1, store result in R2
CPR R2 R1
CMP R2 R3
SET RX #0x4D
BRA RX
SET RX #0x45
JMP RX
NOP
% Finally Stop
HLT
